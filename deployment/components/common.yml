---
  # Remember to add the public key as deploy key for this repository
  - include: $prudentia_dir/tasks/ssh-key.yml ssh_user=$ansible_user_id ssh_group=$ansible_user_id ssh_dir=/home/$ansible_user_id files_dir=$root_dir/components/files/ssh key_name=id_rsa

  - include: $prudentia_dir/tasks/github.yml ssh_dir=/home/$ansible_user_id

  - name: Apollo Common | Create directory
    file: dest=$install_dir owner=$ansible_user_id group=$ansible_user_id mode=755 state=directory
    sudo: yes

  - name: Apollo Common | Checkout git repository
    git: repo=$git_repository dest=$install_dir version=$version
    when: not share
    register: checkout
    tags:
      - update
      - client
      - server

  - name: Apollo Common | Fake checkout (sharing mode)
    command: /bin/true
    when: share
    register: checkout
    tags:
      - update
      - client
      - server
